<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Watir User Guide</title>
  <meta name="author" content="Jonathan Kohl">
  <meta name="generator" content="By hand, with a text editor.">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="user_guide.css">
</head>
<body>
<table>
		<tr>
			<td><img src="images/watir.gif" alt=""></td>
			<td>
			<h1>Watir User Guide</h1>
			</td>
		</tr>
</table>
<h2>Introduction</h2>
<p>"Watir" (pronounced <em>water</em>) stands for "Web Application
Testing in Ruby". Watir is an automated test tool which uses the <a
	href="http://www.ruby-lang.org/en/">Ruby</a> scripting language to drive
the Internet Explorer web browser. Watir is a toolkit for automated
tests to be developed and run against a web browser.</p>
<h3>What Does Watir Work With?</h3>
<p>Watir will drive web applications that are served up as HTML
pages in a web browser. Watir will not work with ActiveX plugin
components, Java Applets, Macromedia Flash, or other plugin
applications. To determine whether Watir can be used to automate a part
of a web application, right click on the object and see if the <em>View
Source</em> menu option is available. If you can view the HTML source, that
object can be automated using Watir.</p>
<h3>Prerequisites</h3>
<p>To use the tool, you should have a basic understanding of:</p>
<ul>
	<li><em>HTML</em>:
	This is a basic <a href="http://www.w3.org/MarkUp/Guide/">HTML
	tutorial</a>.</li>
	<li><em>Programming</em>: You
	should understand programming basics, including variables and simple
	control structures like "for" loops and "if" statements.</li>
	<li><em>Ruby</em>: You do not need
	to know how to program in Ruby to get started with Watir, but you
	should learn some Ruby if you really want to get the most out of Watir.
	<ul>
		<li>Check out the <a
			href="http://wtr.rubyforge.org/s101/doc/Ruby-cheat-sheet.doc">Ruby
		Cheat Sheet</a> for basic Ruby information.</li>
	</ul>
	</li>
	<li>Microsoft has a 
	<a href="http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&amp;displaylang=en">
	toolbar for Internet Explorer</a> which can be
	useful in navigating the DOM for pages that you're looking to automate.
	</li>
</ul>
<h1>Getting Started</h1>
<p>Watir runs on Windows machines and works with the Internet
Explorer web browser. Watir has been developed and tested using Ruby
1.8.2-14 and later on Windows 2000 and XP.</p>
<h2>Installation</h2>
<h3>Step 1 - Install Ruby</h3>
<p>On Windows, the simplest way to install Ruby is to download and
run the <a href="http://rubyforge.org/frs/?group_id=167">One Click
Windows Installer</a>.</p>
<p>Once Ruby is installed on your machine, you can run files with
the ".rb" extension by clicking them or running them from the command
line. Running from the command line is recommended if you want to read
program output, including test results and error messages.<br>
</p>
<h3>Step 2 - Install Watir</h3>
<h4>Watir Releases</h4>
<em>Official Release</em>
<p>The way to install Watir is to use the gem: "gem install watir". You
don't have to download the gem first. Ruby's gem system will
automatically find it on the web, download it and install it. (Ruby gems
are similar to Perl's CPAN, if you know what that is.) Watir's gem
includes libraries, the unit tests and the rdoc, but not the examples or
the rest of the Watir documentation. It is convenient for setting up a
new machine to run Watir scripts that you've already developed.</p>
<em>Development Version</em>
<p>This is the latest version that is currently being worked on by
the Watir development team. It is on the cutting edge, so it may have
problems that haven't been fixed yet, or partially completed new
features. Unless you really want the latest and greatest version, it is
recommended to use a regular Watir release. Go to
<a href="http://wiki.openqa.org/display/WTR/Development+Builds">
Development Builds</a> page for instructions.</p>
<h3>Step 3 - Run the Watir Unit Tests</h3>
<p>To run the unit tests:</p>
<ol>
	<li>Select <strong>Start &gt; Run</strong> and enter <em>cmd</em> in the Open
	field to open a DOS command prompt. Click OK.</li>
	<li>Change directories to the <strong>unittests</strong> directory in your
	Watir install (for example,
	<em>cd \ruby\lib\ruby\gems\1.8\gems\watir-1.5.2\unittests</em> if you
	installed Ruby to C:\ and you have Watir 1.5.2).</li>
	<li>To run all the tests, type <strong>core_tests.rb</strong> and hit Enter
	at the command prompt. The tests should all run and pass.</li>
</ol>
<h4>Having Problems?</h4>
<p>Running on <strong>Windows XP</strong> and Internet Explorer prevents you
from running the unit tests? If you are using Windows XP with Service
Pack 2, you may not be able to run the tests unless you enable active
content.</p>
<p>If the website you are testing has active content, the IE browser
will "block" the content. To enable active content perform the
following:</p>
<ol>
	<li>From the browser, select Tools &gt; Internet Options</li>
	<li>Select the Advanced tab</li>
	<li>Under Security, check "Allow active content to run in files on My Computer"</li>
	<li>Click OK</li>
</ol>
There is more information on <a href="http://www.winxptutor.com/lmzunlock.htm">this page</a>.
<p><strong>Warning!</strong> Allowing active content to run in files on your
computer is a security risk. You only need that enabled for running unit tests.
Do not forget to disable it after unit tests are finished.</p>
<p>Seeing a Runtime Error running the unit tests? There have been
problems with a package in the Ruby 1.8.1-13 release. Try either a newer
version, or an older version such as 1.8.1-11 or 1.8.1-12</p>
<h3>Step 4 - Run the Watir Examples</h3>
<p>To run the Watir example tests:</p>
<ol>
	<li>Change directories to the <strong>examples</strong> directory in your
	Watir install.</li>
	<li>Type the name of the test at the command prompt (ex. <strong>googleSearch.rb</strong>),
	and press Enter to run it.</li>
	<li>Look at the source code of the examples and compare it to the
	web application that it tests
	<ul>
		<li>Right click on the Ruby test file and select <em>Edit</em> to
		view its source code in the SciTE editor.</li>
	</ul>
	</li>
</ol>
<p>To inspect <strong>googleSearch.rb</strong> with a detailed explanation,
read the <a href="http://www.openqa.org/watir/example_testcase.html">Watir
Example Test Case</a> guide.<br>
</p>
<p>These examples are not included with the gem install.<br>
</p>
<h1>Developing Test Cases</h1>
<p>The goal of this user guide is to help you get started writing
test cases quickly. Each section below describes the methods for driving
a web application. Select the ones you need for each page of your web
application based on the content of each page in the application.</p>
<p>Plan what you need to get Watir to do before you begin scripting.
Open your web browser with the application under test in front of you,
and pay close attention to the objects on that page. What text fields
require entries? What buttons need to be pushed? What links need to be
clicked on? It sometimes helps to write out the steps it will take to
exercise a test first, and then filling in the Watir scripting code to
satisfy each of those steps.</p>
<p>Microsoft has an extension for Internet Explorer that is a great
addition to any tester's toolkit and is a great help when scripting web
pages using Watir. The latest version as of now is beta 3 which you can
download <a
	href='http://www.microsoft.com/downloads/details.aspx?FamilyID=e59c3964-672d-4511-bb3e-2d5e1db91038&amp;displaylang=en'>
here</a>.</p>
The Internet Explorer Developer Toolbar provides several features for
exploring and understanding Web pages. These features enable you to:
<ul>
	<li>Explore and modify the document object model (DOM) of a Web
	page.</li>
	<li>Locate and select specific elements on a Web page through a
	variety of techniques.</li>
	<li>View HTML object class names, ID's, and details such as link
	paths, tab index values, and access keys.</li>
	<li>Outline tables, table cells, images, or selected tags.</li>
	<li>Display image dimensions, file sizes, path information, and
	alternate (ALT) text.</li>
	<li>Selectively clear the browser cache and saved cookies. Choose
	from all objects or those associated with a given domain.</li>
	<li>Find the style rules used to set specific style values on an
	element.</li>
	<li>View the formatted and syntax colored source of HTML and CSS.

	</li>
	<li>Style Tracer: Right mouse click on a style value for an
	element and select Style Tracer to find the style rule that is
	effecting that value.</li>
	<li>View Source: View the formatted and syntax colored source of
	the original page, currently rendered page, element or element with the
	styles that are effecting it.</li>
</ul>
<p>
To use this extension, in IE6 you can turn it on through the View Menu > Explorer Bar >
IE DOM Explorer
In IE7, it's under the Tools icon > Toolbars > Explorer Bar > IE DOM Explorer

</p>
<p>Navigate to "Google Search", and you should see something like the 
following. 
</p>

<img src='images/google_ie_dev.jpg' alt='ie view on google with the developer toolbar'>


<p>
In this case you can see the name attribute of the field to use in your scripts. 
Watir can use different attributes of a tag to
manipulate that object, so it is important to know what they are. In
some cases the attributes are not explicit in the tag such as the "text"
attributes.</p>
<p>To start developing a test:</p>
<ol>
	<li>Open your text editor.</li>
	<li>Name your test file with a <strong>.rb</strong> (Ruby) extension.</li>
	<li>Provide your new test file with access to the Watir tool by
	entering this statement at the beginning of your test script: <strong>require
	'watir'</strong></li>
	<li>Open Internet Explorer and navigate to the application you
	wish to test</li>
	<li>Interact with it to design your test case</li>
	<li>Using the Watir methods below, type the corresponding Watir
	methods into your test script</li>
	<li>Verify the results</li>
</ol>
<h2>Interacting With a Web Page</h2>
<p>You will notice we've chosen to name the variable name <strong>ie</strong>
used in Watir test scripts for the Internet Explorer browser.You could
call it whatever you wish, but we use "ie" for ease of use. This
variable tells the Watir library to exercise test scripts against an
instance of the Internet Explorer web browser.</p>
<p>In Ruby, think of programming in terms of objects and messages.
Watir was also developed with objects and messages in mind. If you think
of the <strong>ie</strong> variable as an object, you can send messages to it.
Think of objects as nouns. When you start up Internet Explorer, the
operating system starts the program which creates an instance of the
Internet Explorer web browser. You refer to this Internet Explorer
browser instance as a thing. If you send a message to that object, it
will respond to that message if it recognizes it.</p>
<p>Think of the messages as verbs. In Ruby, you send a message to an
object by separating the object you are calling from the message you are
sending to it with a dot. For example, <strong>dog.bark</strong> would tell the
object <em>dog</em> that it must <em>bark</em>.</p>
<p>This isn't very specific though. What dog should bark? In the
Watir world, you could identify the test area to be our <strong>yard</strong>.
Like <em>ie</em>, treat it as an object with attributes containing other
objects with attributes. For example, in our yard, there are two dogs:
Heidi and Megabyte. Each of these dog objects have attributes that
identify them. They have names, breeds, shapes and sizes and colors. To
be more specific, and interacting with them the Watir way, you could
send the message "bark" to the dog Heidi like this: <strong>yard.dog(:name,
"Heidi").bark</strong>. This says in Watir syntax: in the yard, identify the dog
Heidi by her name attribute, and send her the "bark" message. The
expected outcome would be Heidi responding to the message by barking.</p>
<p>When you develop test scripts with Watir, you interact with
objects on a web page by sending them messages. Like the yard example,
the Internet Explorer browser itself contains objects. You can access
these objects within an Internet Explorer browser instance by
identifying them by different attributes. Just like in the dog example,
above, you must be very specific when you send messages to objects on a
web page. You must also be able to identify objects on a web page by
using a variety of different attributes due to the diversity in how tags
are declared by different application developers. With Watir, identify
objects and send them messages by using the dot notation. For example <strong>ie.button</strong>,
narrows down the type of object to send a message to. <strong>ie.button(:value,
"Click Me").click</strong> identifies the object on the page as a button within
the instance of Internet Explorer that has the value attribute (caption)
"Click Me". When you send the message (the verb) <strong>click</strong>, Watir
interprets and tells Internet Explorer to click.</p>
<h2>Watir Syntax</h2>
<p>The Watir syntax is shown below with three views. One is the view
that we see objects on a web page while viewing them in a web browser.
The next view is an example of the Watir code that would be needed to
automate an action using that web page object. The third view is the
object on the web page shown in its HTML form. This is the way it looks
when we view the source of a web page, or open the file in a text
editor.</p>
<h2>Require the Watir Tool</h2>
<p>To use the Watir tool, first enter the following in your test
script:</p>
<div class="testexample">require 'watir'</div>
<p>This allows our test script to use the Watir tool.</p>
<h2>Create a Test Instance of Internet Explorer</h2>
<p>To create a test instance of Internet Explorer, enter the
following in your test script:</p>
<div class="testexample">ie = Watir::IE.new</div>
<p>Watir sends a message to Internet Explorer, telling to create a
new instance of itself, and assigns that instance to "ie".</p>
<p>To create an instance of Internet Explorer and navigate to the
site with one statement:</p>
<div class="testexample">ie = Watir::IE.start("http://mytestsite")</div>
<p>Watir uses the <em>start</em> method to both create a browser
instance and navigate to a site.</p>
<h3>Starting Options</h3>
<p>To use the <strong>ie = IE.new</strong> syntax in versions 1.0.1 through
1.0.3, you need to include the Watir module after the <em>require
'watir'</em> statement:</p>
<div class="testexample">include Watir</div>
<p>You can then create a new instance of Internet Explorer like
this:</p>
<div class="testexample">ie = IE.new</div>
<h2>Site Navigation</h2>
<p>To direct your test script to the web application you are
testing, enter the URL in this command:</p>
<div class="testexample">ie.goto("http://mytestsite")</div>
<p>In the example above, enter in your application's URL in place of
<em>mytestsite</em>.</p>
<p>Watir sends the goto message to Internet Explorer, telling it to
enter the address you entered as a method argument in the Address bar,
and to direct the browser to that site.</p>
<h2>Manipulating Web Page Objects</h2>
<p>These examples will demonstrate how to use Watir to interact with
objects on the page.</p>
<h3>Hyperlinks</h3>
<p>You can use Watir to click hyperlinks in a variety of ways. Watir
can click links by looking at the link text you see in the browser (text
attribute) or by looking at the attributes available in the HTML tag.
Attributes in the tag can include: <em>name</em>, <em>href</em> (we refer to
it here as URL) among others.</p>
<p>Here is an example using a link to the "Pickaxe" book by the
Pragmatic Programmers:</p>
<p>What you see in the web browser:</p>
<div class="browserexample"><a
	href="http://pragmaticprogrammer.com/titles/ruby/">Pickaxe</a></div>
<h4><em>Text</em> Attribute</h4>
<p>This is the Watir code you need to click a hyperlink using the <em>text</em>
attribute:</p>
<div class="testexample">ie.link(:text, "Pickaxe").click</div>
<p>What you see in the HTML source (attribute highlighted):</p>
<div class="htmlexample">&lt;a
href="http://pragmaticprogrammer.com/titles/ruby/"&gt;<strong>Pickaxe</strong>&lt;/a&gt;</div>
<h4><em>URL</em> Attribute</h4>
<p>Watir code to click a link using the URL attribute:</p>
<div class="testexample">ie.link(:url,
"http://pragmaticprogrammer.com/titles/ruby/").click</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;a href="<strong>http://pragmaticprogrammer.com/titles/ruby/</strong>"&gt;Test
Site&lt;/a&gt;</div>
<h3>Checkboxes</h3>
<p>Watir <em>sets</em> or <em>clears</em> checkboxes based on the <em>name</em>
and <em>value</em> attributes provided in the <em>checkbox</em> HTML tag.</p>
<h4><em>Name</em> Attribute</h4>
<p>What you see in the web browser:</p>
<div class="browserexample">Check Me: <input name="checkme"
	value="1" type="checkbox"></div>
<p>Watir code to <em>set</em> a checkbox using the <em>name</em>
attribute:</p>
<div class="testexample">ie.checkbox(:name, "checkme").set</div>
<p>Watir code to <em>clear</em> a checkbox using the <em>name</em>
attribute:</p>
<div class="testexample">ie.checkbox(:name, "checkme").clear</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;input type = "checkbox" name = "<strong>checkme</strong>"
value = "1"&gt;</div>
<h4><em>Name</em> and <em>Value</em> Attributes</h4>
<p>We can also use both attributes:</p>
<p>Watir code to <em>set</em> a checkbox using both the <em>name</em>
and <em>value</em> attributes:</p>
<div class="testexample">ie.checkbox(:name, "checkme", "1").set</div>
<p>This is the tag in the HTML source with both the attributes
highlighted:</p>
<div class="htmlexample">&lt;input type = "checkbox" name = "<strong>checkme</strong>"
value = "<strong>1</strong>"&gt;</div>
<p>We can also use the <em>clear</em> method using both of these
attributes.</p>
<h3>Radio Buttons</h3>
<p>Watir <em>sets</em> or <em>clears</em> radio list items based on the
<em>name</em> and <em>value</em> attributes provided in the <em>radio</em>
HTML tag.</p>
<p>What you see in the web browser:</p>
<div class="browserexample">Click Me: <input name="clickme" id="1"
	type="radio"></div>
<h4><em>Name</em> Attribute</h4>
<p>Watir code to <em>set</em> a radio list item using the <em>name</em>
attribute:</p>
<div class="testexample">ie.radio(:name, "clickme").set</div>
<p>Watir code to <em>clear</em> a radio list item using the <em>name</em>
attribute:</p>
<div class="testexample">ie.radio(:name, "clickme").clear</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;input type = "radio" name = "<strong>clickme</strong>"
id = "1"&gt;</div>
<h4><em>Name</em> and <em>id</em> Attributes</h4>
<p>We can also use both attributes:</p>
<p>Watir code to <em>set</em> a radio list item using both the <em>name</em>
and <em>id</em> attributes:</p>
<div class="testexample">ie.radio(:name, "clickme", "1").set</div>
<p>This is the tag in the HTML source with both the attributes
highlighted:</p>
<div class="htmlexample">&lt;input type = "radio" name = "<strong>clickme</strong>"
id = "<strong>1</strong>"&gt;</div>
<p>We can also use the <em>clear</em> method using both of these
attributes.</p>
<h3>Selection Boxes</h3>
<p>Watir <em>selects</em> an item in a selection box (or dropdown box)
based on the <em>name</em> and <em>option value</em> attributes provided in
the <em>select</em> HTML tag. Or we can identify it based on the <em>name</em>
attribute, and the value we want to set.</p>
<p>What you see in the web browser:</p>
<div class="browserexample">Select Me: <select name="selectme">
	<option name="1"></option>
	<option name="2">Web Testing</option>
	<option name="3">in Ruby</option>
	<option name="4">is fun</option>
</select></div>
<p>Watir code to <em>set</em> a select box item using the <em>name</em>
attribute and the value to set:</p>
<div class="testexample">ie.select_list( :name ,
"selectme").select("is fun")</div>
<p>This is the tag in the HTML source with the attributes
highlighted:</p>
<div class="htmlexample">&lt;select name = "<strong>selectme</strong>" &gt;
&lt;option name=1&gt; &lt;option name=2&gt;Web Testing &lt;option
name=3&gt;in Ruby &lt;option name=4&gt;<strong>is fun</strong> &lt;/select&gt;</div>
<p>Watir can also <em>clear</em> a select box:</p>
<div class="testexample">ie.select_list( :name ,
"selectme").clearSelection</div>
<h2>Entering Data into a Web Page</h2>
<p>Watir <em>sets</em> text in an input field on a web page based on
the <em>name</em> and <em>id</em> attributes provided in the <em>input
type = text</em> HTML tag.</p>
<h3>Text Fields</h3>
<p>What you see in the web browser:</p>
<div class="browserexample">Type in Me: <input name="typeinme"
	type="text"></div>
<p>Watir code to <em>set</em> the field with the text string: "Watir
World" using the <em>name</em> attribute:</p>
<div class="testexample">ie.text_field(:name,
"typeinme").set("Watir World")</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;input type = "text" name = "<strong>typeinme</strong>"
&gt;</div>
<p>Watir can also <em>clear</em> a text field:</p>
<div class="testexample">ie.text_field(:name, "typeinme").clear</div>
<h2>Submitting Data from a Web Page</h2>
<p>In web applications, we generally submit information we have
entered or selected in the web page by clicking hyperlinks (see above
example), clicking buttons, or images that look and act like HTML
buttons, or by hitting Enter/Return on our keyboard.</p>
<h3>Buttons:</h3>
<p>Watir <em>clicks</em> buttons on a web page based on the <em>name</em>,
<em>value</em> (caption) and <em>id</em> attributes provided in the <em>input
type = button</em> HTML tag. Some buttons are images which will show as <em>input
type = image</em> in the HTML tag. These buttons can also be accessed by
their src attribute.</p>
<h4>HTML Buttons</h4>
<p>What you see in the web browser:</p>
<div class="browserexample"><input name="clickme" value="Click Me"
	type="button"></div>
<h4><em>Value</em> or <em>Caption</em> Attribute</h4>
<p>This is the Watir code you need to click a button using the <em>value</em>
attribute:</p>
<div class="testexample">ie.button(:value, "Click Me").click</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;input type = "button" name =
"clickme" value = "<strong>Click Me</strong>"&gt;</div>
<h4><em>Name</em> Attribute</h4>
<p>This is the Watir code you need to click a button using the <em>name</em>
attribute:</p>
<div class="testexample">ie.button(:name, "clickme").click</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;input type = "button" name = "<strong>clickme</strong>"
value = "Click Me"&gt;</div>
<h4>Image Buttons</h4>
<p>Watir can click image buttons on a web page based on the
attributes above: name, id, value as well as the src HTML tag.</p>
<h4><em>Src</em> Attribute for an Image button</h4>
<p>What you see in the web browser:</p>
<div class="browserexample"><img src="images/doit.gif" name="doit"
	alt=""></div>
<p>This is the Watir code you need to click a button with an image
using the <em>src</em> attribute as a regular expression:</p>
<div class="testexample">ie.button(:src, /doit/).click</div>
<p>In this case we're looking for a button with <em>doit</em> as part
of the src attribute.</p>
<p>This is the tag in the HTML source with our partial match in the
src attribute highlighted:</p>
<div class="htmlexample">&lt;input type="image" src = "images/<strong>doit</strong>.gif"
name = "doit"&gt;</div>
<h3>Forms</h3>
<p>Forms aren't visible through the browser, but are used a lot in
web applications. To find them, look at the HTML source for
&lt;form&gt;&lt;/form&gt; tags. Watir can submit forms in a variety of
ways.</p>
<h4>Buttons in Forms</h4>
<p>Watir can <em>submit</em> HTML buttons on a web page contained in a
form based on the <em>name</em>, <em>value</em> (caption) and <em>id</em>
attributes provided in the <em>input type = submit</em> HTML tag.</p>
<div class="browserexample">
<form action="submit" name="submitform" method="post"><input
	value="Submit" type="submit"></form>
</div>
<h4><em>Value</em> or <em>Caption</em> Attribute</h4>
<p>This is the Watir code you need to click a button that will
submit a form using the <em>value</em> attribute:</p>
<div class="testexample">ie.button(:value, "Submit").click</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;form action = "submit" name =
"submitform" method="post"&gt;&lt;input type = "submit" value = "<strong>Submit</strong>"&gt;&lt;/input&gt;&lt;/form&gt;</div>
<p>We can also just submit the form as shown below in the Forms With
No Buttons examples.</p>
<h4>Forms With No Buttons</h4>
<p>There may be input fields on a web page, but no button to submit.
Instead, they will allow you to hit Enter on your keyboard. When there
is no button to submit the data, we can just submit the form itself.</p>
<p>Watir can submit a form by identifying it by its <em>name</em>, <em>action</em>
and <em>method</em> attributes.</p>
<h4><em>Name</em> Attribute</h4>
<p>What you see in the web browser:</p>
<div class="browserexample">Enter name and hit Enter/Return:
<form action="login" name="loginform" method="get"><input
	name="username" type="text"></form>
</div>
<p>Watir code to submit the form using the <em>name</em> attribute:</p>
<div class="testexample">ie.form(:name, "loginform").submit</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;form action = "login" name = "<strong>loginform</strong>"
method="get"&gt;&lt;input name="username"
type="text"&gt;&lt;/input&gt;&lt;/form&gt;</div>
<h4><em>Action</em> Attribute</h4>
<p>Watir code to submit the form using the <em>action</em> attribute:
</p>
<div class="testexample">ie.form(:action, "login").submit</div>
<p>This is the tag in the HTML source with the attribute
highlighted:</p>
<div class="htmlexample">&lt;form action = "<strong>login</strong>" name =
"loginform" method="get"&gt;&lt;input name="username"
type="text"&gt;&lt;/input&gt;&lt;/form&gt;</div>
<h2>Frames</h2>
<p>Many web applications use frames. If you are having trouble
accessing objects on a web page, be sure to check to see if the
application is using frames. To find out, view the source of the page.
It will look something like this:</p>
<div class="htmlexample">&lt;frameset cols="120,*"&gt;<br>
&lt;frame src="menu.html" name="menu" &gt;<br>
&lt;frame src="main.html" name="main" &gt;<br>
&lt;/frameset&gt;</div>
<p>In the HTML above, we have a menu frame on the left that is 120
pixels wide, and a main frame that makes up the rest of the page.</p>
<p>You can use Watir to find out if your page has frames:</p>
<div class="testexample">ie.show_frames</div>
<p>This is a good method to use with IRB. It prints out the number
and the names of the frames in the current page.</p>
<p>Watir allows access to frame objects by identifying them by their
name attribute. This is the form that Watir takes to access a frame:</p>
<div class="testexample">ie.frame("menu")</div>
<p>To access individual objects within that frame, you prefix the
object using the Watir code above. If we had a hyperlink in the menu
frame: <a href="">Click Menu Item</a>, we could click it like this:</p>
<div class="testexample">ie.frame("menu").link(:text, "Click Menu
Item").click</div>
<h4>Nested Frames</h4>
<p>Sometimes a web page that is referenced by the <strong>frame src=</strong>
attribute is also a page that contains a <strong>frameset</strong> tag. This is a
nested frame. To deal with this, simply access the nested frame like
this:</p>
<div class="testexample">ie.frame("frame1").frame(:name,
"nested_frame")</div>
<h2>New Windows</h2>
<p>Some web applications will have popup windows or new windows that
contain HTML. Watir has an <strong>attach</strong> method that allows you to
access and control the new window. If you click a button or link that
opens a new window, you can attach to it by identifying the window by
its URL or by the Window title:</p>
<div class="testexample">ie2 = Watir::IE.attach(:url,
'http://mytestsite')</div>
<div class="testexample">ie3 = Watir::IE.attach(:title, 'Test New
Window')</div>
<p>You can use a regular expression on URL or title like this:</p>
<div class="testexample">ie4 = Watir::IE.attach(:title, /Test
New/)</div>
<p><em>Note: be careful to not assign the new window to your "ie"
variable. Give the attached window variable a different name.</em></p>
<h2>Validating Test Results</h2>
<p>How do we tell whether the test passed or failed? It is good
practice to use a verification point in your test case.</p>
<p>To create a valid test case, we need to use some sort of
validation. It isn't enough to have a sequence of events without
validation in a test script. Watir can check the state of objects in the
<a href="http://msdn.microsoft.com/workshop/author/om/doc_object.asp">Internet
Explorer DOM</a>, and can check to see if a page contains the objects that
are expected for the test to pass.</p>
<p></p>
<h3>Object Exists</h3>
<p>A simple verification point is to use the Watir method <em>contains_text</em>:</p>
<p>In our test, imagine we have gone through a sequence of steps to
reach the desired point. This is a web page that contains the following
text:</p>
<div class="browserexample">Reached test verification point.</div>
<p>Our test will pass if this is what is displayed on the page at
our verification point.</p>
<p>Watir code to check that the text exists on the web page <em>contains_text</em>
method:</p>
<div class="testexample">ie.contains_text("Reached test
verification point.")</div>
<p>We will need to add some scripting code to validate that this
occurred, or use Ruby's test::unit testing framework.</p>
Scripting code to let us know whether the test passed or not:
<p></p>
<div class="testexample">if ie.contains_text("Reached test
verification point.") <br>
&nbsp; puts: "Test passed. Page contains the text: Reached test
verification point."<br>
else<br>
&nbsp; puts: "Test failed! Page didn't contain text: Reached test
verification point."<br>
end</div>
<p></p>
<p>This is what the scripting code above does:</p>
<ol>
	<li>assign this method call to, and store results in variable <em>a</em></li>
	<li>if <em>a</em> is false, the page did not contain the text:
	"Reached test verification point."</li>
	<li>print our failure message to the screen</li>
	<li><em>a</em> is not false, meaning it is true; the page did
	contain the text we are looking for</li>
	<li>print our passing message to the screen</li>
	<li>end our <em>if</em> block</li>
</ol>
<p></p>
<h3>Using test::unit Assertions</h3>
<p>Using xUnit assertions can be a more powerful way of validating
test results. (For a good explanation of assertions, visit this NUnit
page which <a href="http://www.nunit.org/assertions.html">explains
assertions</a>.)</p>
<p>Ruby has an xUnit framework called <strong>test::unit</strong> that we can
use with Watir. The test::unit API is avaiable in the project <a
	href="http://www.ruby-doc.org/stdlib/libdoc/test/unit/rdoc/"> RDoc</a>.</p>
<em>Note:</em>
Look at the Watir examples and unit tests for executable examples.
<p></p>
<p>To use test::unit in your test scripts, enter the following in
your test script:</p>
<h4>Require test::unit</h4>
<div class="testexample">require 'test/unit'<br>
</div>
<h4>Create a Test Instance</h4>
<p>We create a new class for our test suite which is inherited from
the test::unit <strong>TestCase</strong> class.</p>
<p></p>
<div class="testexample">class TC_myTest &lt; Test::Unit::TestCase<br>
&nbsp;&nbsp;<em>...fill in Test Case methods here...</em><br>
end</div>
<h4>Create a Test Case Method</h4>
<p>Within our test case class, we need to declare test cases as <em>methods</em>
like this:<br>
</p>
<div class="testexample">def test_myTestCase<br>
&nbsp;&nbsp;<em>fill in method body with Watir code and assertion
here</em><br>
end</div>
<p>Test case method names must be prefixed with the word <em>test</em>.</p>
<p>When we run the test script from the command line, test::unit
uses reflection to go through our test class and execute all the test
cases declared in it. The runner by default executes the test cases
randomly, so if you need to chain test cases, prefix letters from the
alphabet or numbers after the "test" prefix to force them to run in
order. ex. "test_a_mytest".</p>
<p><em>Note:</em>If you use numbers in your method names, note that 1
2 3 4 5 6 7 8 9 10 11 12 will be executed in this order: 1 10 11 12 2 3
4 5 6 7 8 9. Instead, use this format: 01 02 03 04 05 06 07 08 09 10 11
12. ex. "test_01_mytest", "test_02_mytest", "test_03_mytest" will run in
the order expected.</p>
<p>The test case class with test cases defined will look like this:</p>
<div class="testexample">class TC_myTest &lt; Test::Unit::TestCase<br>
&nbsp;&nbsp;def test_ myTestCase<br>
&nbsp;&nbsp;&nbsp;&nbsp;<em>Watir code and assertion here...</em><br>
&nbsp;&nbsp;end<br>
&nbsp;&nbsp;def test_anotherTestCase<br>
&nbsp;&nbsp;&nbsp;&nbsp;<em>Watir code and assertion here...</em><br>
&nbsp;&nbsp;end<br>
&nbsp;&nbsp;def test_aTestCase<br>
&nbsp;&nbsp;&nbsp;&nbsp;<em>Watir code and assertion here...</em><br>
&nbsp;&nbsp;end<br>
end</div>
<h4>Use Assertions</h4>
<p>Watir can support assertions by wrapping Watir methods within an
<em>assert</em>:</p>
<div class="testexample">assert(ie.contains_text("Reached test
verification point.")</div>
<p>Watir can test for many different states of objects. We can use
assertions to check of objects <em>exist</em>, are <em>enabled</em> or <em>disabled</em>,
or any other state that the DOM tells the web browser about an object.</p>
If you would like to chain test cases in a single test::unit class, and
use one Internet Explorer instance, use either a class variable "@@ie",
or a global variable "$ie". This allows the test script to use the same
Internet Explorer instance for all the test cases.
<p><em>Note: use global variables with caution.</em></p>
<h4>Setup and Teardown</h4>
<p>The method names <strong>setup</strong> and <strong>teardown</strong> are reserved
for test::unit. If you would like to use setup and teardown
functionality, simply use those as method names for the actions you want
executed before and after executing <em>each</em> test case.</p>
<div class="testexample">def setup<br>
&nbsp;&nbsp;<em>fill in code that will run <strong>before every</strong> test
case here...</em><br>
end</div>
<div class="testexample">def teardown<br>
&nbsp;&nbsp;<em>fill in code that will run <strong>after every</strong> test
case here...</em><br>
end</div>
<h2>Tips and Tricks</h2>
<h3>Online Resources</h3>
<p>Have a question? Check the <a
	href="http://wiki.openqa.org/display/WTR/FAQ"> Watir FAQ</a> or search
the Watir mailing list archives using Google. Search by entering the
following<br>
site:rubyforge.org "[Wtr-general]" <em>your search term</em><br>
If you wanted to search for information on JavaScript popups, you would
enter this:<br>
site:rubyforge.org "[Wtr-general]" javascript popups</p>
<h3>Popup Windows</h3>
<p>JavaScript generated popups such as Alert boxes, Windows Security
popups, and other popups that are not contained in a web browser are not
accessible the same way HTML pages are. There has been some experimental
code packaged with Watir to deal with popups with limited success. A
good popup handling solution is being worked on and will be included in
a future Watir release. In the mean time, <a
	href="http://www.autoitscript.com/">AutoIT</a> is installed with Watir.
Look at "jscript_test.rb" in the unittests directory, and search the
mail list archives for more information.</p>
<p>Watch for a Watir solution in a future release.</p>
<h4>Running Tests With the Browser Not Visible</h4>
<p>Run the tests with a "-b" option if you don't want the browser to
be visible. ex. myTest.rb -b</p>
<h3>Troubleshooting</h3>
<p>Not all HTML tags will look the same. If you have difficulty
getting Watir to interact with an object on your web page, try the Watir
method with different attributes. The tag may come with one attribute,
or it may come with several. If you still have trouble, see if the
developers will add a <em>name</em> attribute to the offending tag.</p>
<h4>Choosing Attributes</h4>
<p>If you are having difficulty getting Watir to interact with an
object, try using the method with different tag attributes. Tag
declarations in HTML are varied. Some developers use tools that generate
HTML, and there are many variations on tag attributes. Watir is very
flexible and offers several variations on each method. There are also
attributes that are part of the DOM within Internet Explorer. Anything
the DOM can see, you can access using Ruby. If you have exhausted the
attributes on a tag and Watir still won't interact with it, send an
email to the wtr-general mailing list. The Watir development team will
help out, and if needed, add support for that situation within Watir.</p>
<h4>Accessing Tags Using Alternate Methods</h4>
<p>In some situations, you may not know what the tag attributes of
an HTML object are. They may be missing, or the tag attributes might be
dynamically generated. Some web architectures dynamically generate tags,
and the attributes might change each time you run a test. To work around
this, try the following:</p>
<p><strong>Access Element Using Index</strong></p>
<p>Elements on a web page can be accessed by where they appear on a
page. If an element you want to interact with always appears in the same
place, you can access it by a one-based index. Here's an example using a
radio list:</p>
<p>What you see in the web browser:</p>
<div class="browserexample">Radio 1: <input name="clickme1" id="1"
	type="radio"> <br>
Radio 2: <input name="clickme2" id="2" type="radio"> <br>
Radio 3: <input name="clickme3" id="3" type="radio"></div>
<p>Watir code to set the first radio list item using its index:</p>
<div class="testexample">ie.radio(:index, 1).set</div>
<p>Watir code to clear the second radio list item using its index:</p>
<div class="testexample">ie.radio(:index, 2).clear</div>
<h4>Using Regular Expressions</h4>
<p>Watir supports regular expressions in method calls.</p>
<p>Here is an example using the <em>link</em> method to click a
hyperlink using the <em>url</em> attribute:</p>
<div class="testexample">ie.link(:url, /shtml/).click</div>
<p>This will click the link that matches <em>shtml</em>.</p>
<h4>CSS: Messages in Div tags</h4>
<p>Watir supports div tags. Some web applications use one <em>div</em>
for one state of the application, and another for a different state
(such as error or success messages). Watir can check the status of the
div to allow for tests on pages using CSS as part of the application.</p>
<p>Check out the unit test <strong>css_test.rb</strong> for usage.</p>
<h4>Running a Test Concurrently</h4>
<p>To run a test concurrently, check out <strong>concurrent_search</strong> in
the <em>examples</em> directory for an example.</p>
<h4>Tree Views</h4>
<p>Watir now supports JavaScript treeviews such as the <a
	href="http://www.ivanpeters.com/">Joust tree view</a>. The <a
	href="http://wiki.openqa.org/display/WTR/FAQ">Watir FAQ</a> has an
example you can follow.</p>
<h4>Multiple Windows</h4>
<p>Watir now handles multiple browser windows with the <strong>attach</strong>
method.</p>
<h4>File Upload</h4>
<p>Watir now has a mechanism to support file uploads. Use the
file_field method. Run and view the Ruby source in:"filefield_test.rb"
in the unittests folder for usage.</p>
<h4>RDoc</h4>
<p>Watir has RDocs generated which describe the classes and methods
in the Watir tool. To view the Watir RDoc, go to the <em>rdoc</em>
directory and click on <strong>index.html</strong></p>
<h2>Using IRB and Watir</h2>
<p>Use Ruby's Interactive Command Interpreter to test out script
ideas. You can try out test script ideas interactively with irb.</p>
<p>To start IRB on Windows, select Start &gt; Run and type "irb" in
the Open field. Click "OK", and a DOS console should open with a command
prompt that looks like this: <strong>irb(main):001:0&gt;</strong></p>
<p>Use the Watir library and enter commands to start driving a web
browser interactively:</p>
<div class="testexample">irb(main):001:0&gt; <strong>require
'watir'</strong><br>
=&gt; true<br>
irb(main):002:0&gt; <strong>ie = Watir::IE.start("http://<em>mytestsite.com</em>")</strong><br>
</div>
<h3>Use IRB to Find Page Objects</h3>
<p>To find out what objects are on a page you are writing a test
script for, use IRB to get instant feedback.</p>
<p>The <strong>show_all_objects</strong> method is a useful way to identify
the attributes of objects you will need to use in a test script.</p>
<div class="testexample">irb(main):003:0&gt;<strong>
ie.show_all_objects</strong><br>
-----------Objects in page -------------<br>
text name=test_text id= 11 value= alt= src=<br>
submit name=test_button id= 12 value=Click Me alt= click src=<br>
</div>
<p>The objects on the page are shown with their attributes such as
name, id, value, alt, src. You can use these attributes to uniquely
identify the objects needed for a test script. In our example above, we
have two objects. A text field named <strong>test_text</strong> and a button
(submit) named <strong>test_button</strong>.</p>
<p>The <strong>flash</strong> method can be used to test whether you have
identified the object correctly. The flash method causes an object in
the web browser to flash yellow ten times.</p>
<div class="testexample">irb(main):006:0&gt; <strong>ie.text_field(:name,
"test_text").flash</strong><br>
=&gt; nil<br>
</div>
<p>This would cause the text field with the name attribute
"test_text" to flash yellow ten times. This is an effective way of
testing whether you have identified the right object, and if you have
used the right attribute. Using this in IRB is a quick way of finding
out what objects can be used in a test script before commiting the
script to a file.</p>
<h2>Glossary</h2>
<p><strong>Instance</strong> an object that has been created for use by a
program and is stored in memory</p>
<p><strong>Message</strong> an action descriptor that can be sent to an
object. If the object recognizes the message, it will respond and
display related behavior.</p>
<p><strong>Object</strong> something that <em>contains</em> attributes and <em>displays</em>
behavior according to what messages have been sent to it.</p>
<p><strong>Ruby</strong> object-oriented scripting language</p>
<p><strong>Watir</strong> Web Application Testing in Ruby</p>
<h2>Feedback</h2>
<p>Questions? Comments? The Watir development team like to hear your
comments and suggestions for improvement. Email questions and
suggestions to the <a
	href="http://rubyforge.org/mailman/listinfo/wtr-general">wtr-general</a>
mailing list.</p>
</body>
</html>