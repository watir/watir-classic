<html>
<head>
<title>WATIR Example Test Case</title>
<meta name="author" content="Jonathan Kohl" />
<meta name="generator" content="By hand, with a text editor." />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

</head>
<style type="text/css">
body {
	margin-left:	5%;
	margin-right: 5%;
	padding: 0;
	background:	#fff;
	color: #333;
	font: normal small Geneva, Verdana, Arial, sans-serif;
     }
h1   {
       font-size: 175%; 
     }
h2   {
       font-size: 135%; 
     }
h3   {
       font-size: 110%; 
     }
h4   {
       font-size: 100%; 
     }
p    {
       margin-bottom: 10px; 
      }
div.testexample 
     {
       background: #fff;
       margin-left:  10%;
       margin-right: 10%;
       padding: 1em;
       font-family: "Courier New", monospace;
       font-size: 11pt;
       color: black;
       border: 1px solid #000;
       border-width: thin; 
       margin-bottom: 10px;
     }
div.htmlexample 
     {
       background: #ccc;
       margin-left:  10%;
       margin-right: 10%;
       padding: 1em;
       font-family: "Courier New", monospace;
       font-size: 11pt;
       color: blue;
       border: 1px solid #000;
       border-width: thin; 
       margin-bottom: 10px;
     }
     div.browserexample 
     {
       background: #fff;
       margin-left:  10%;
       margin-right: 10%;
       padding: 1em;
       font: normal small Geneva, Verdana, Arial, sans-serif;
       font-size: 11pt;
       color: #000;
       border: 1px solid #000;
       border-width: thin; 
       margin-bottom: 10px;
     }
</style>
<body>
<h1>WATIR Example Test Case</h1>

<h2>Google Test Search</h2>
<p>This document walks through a very simple test case: <b>googleSearch.rb</b>. To begin, from the <b>examples</b> folder in your Watir installation directory, open the 
googleSearch.rb file in a text editor. To open it with SciTE, simply right-click the file in Windows Explorer, and select <b>Edit</b> from the popup menu.</p>
<p>The format of this example will be to show the Ruby test case scripting code in a box as you would see it in a text editor, with an explanation after it.<p>

<h2>Getting Started</h2>
<p>Open Internet Explorer, and try out the test case manually on your own:<br>
<b>Steps:</b><br>
<ol>
<li>go to the Google home page - http://www.google.com </li>
<li>enter "pickaxe" in the search text field</li>
<li>click the "Google Search" button</li>
</ol>
<b>Expected Result:</b><br>
- a Google page with results should be shown. "Pragmatic Programmers LLC" should be high on the list.</p>
<p>Once you have tried the test case out manually, it's time to automate the test case using Watir. Return to the Google home page http://www.google.com
and view the page source: right mouse click > View Source. Now you can follow along and see how to automate this test with Watir based on the HTML tags in the 
Google search web application.</p>

<h2>Section 1: Comments</h2>
<p>Test cases should be commented, just as program code should be commented. In Ruby, any text on a single line that follows a <b>#</b> is a comment, and is ignored by the Ruby interpreter at run time.</p>
<p>What you see in the text editor:</p>
<div class = "testexample"><font color = "green">
#-------------------------------------------------------------#<br>
# demo test for the WATIR controller<br>                                           
# <br>                                                                             
#  Simple Google test written by Jonathan Kohl   10/10/04  <br>                    
# Purpose: to demonstrate the following WATIR functionality: <br>                 
#   * entering text into a text field  <br>                                        
#   * clicking a button<br>
#   * checking to see if a page contains text.    <br>                             
# Test will search Google for the "pickaxe" Ruby book<br>
#<br>
#-------------------------------------------------------------#<br>
</font>
</div>
<p>Styles differ with comments, but they can really help with test case maintenance. In this case, the author has provided their name, a date and a purpose of the test case. This is here to improve readability, and to help others who may be using the test understand what it does.</p>

<h2>Section 2: Includes</h2>
<p>To use Watir, or any other library in our test case requires us to tell the program where to find the library.</p>
<p>What you see in the text editor:</p>
<div class = "testexample">
  <font color = "green"> #includes:</font><br>
   require <font color = "purple">'../watir'</font><font color = "green">   # the watir controller</font>
</div>
<p>In this case, we used a relative path to the watir file "../watir". Since the examples folder is one folder down from the watir.rb file, we can use this notation
instead of the full path: "../". This reads: "Go back out of the folder we are in, and look for the file we need there." We can also use a full path such as: "C:\my folder\Watir\watir"</p>

<h2>Section 3: Declare Variables</h2>
<p>If we are going to use something in our script more than once, or something that could change, we can declare it as a variable and reuse it throughout the script. 
Some objects we can use for testing tend to change, such as URLs for applications we are testing. In this script, we assign the test URL as a variable. If it changes, 
we only have to change it in one place.
</p>
<p>What you see in the text editor:</p>
<div class = "testexample">
<font color = "green"> #variables:</font><br>
   testSite = <font color = "purple">'http://www.google.com'</font>
</div>
<p>The test case author has chosen to assign the URL to a variable called <b>testSite</b>. It may not be much of an issue in this test case, but using variables for test URLs is often a good practice. </p>

<h2>Section 4: Open an Internet Explorer Browser</h2>
<p>To begin driving Internet Explorer, we need to tell Watir to open an instance for testing.</p>
<p>What you see in the text editor:</p>
<div class = "testexample">
  <font color = "green">#open the IE browser</font><br>
   $ie = IE.new<br>
</div>
<p>To explain what this is doing, we can start from the right of the "=" operator. We send a message "new" to the "IE" (Internet Explorer) object, and assign it to a variable called "$ie".
The "$ie" variable is a global variable which means we can access it anywhere in our script. the $ in front of the variable name tells the Ruby interpreter that it is global.
We want this to be a global variable so we can access the Internet Explorer browser at any time in our script. Now we can refer to the Internet Explorer object in our script by using
the "$ie" variable. This saves typing and helps make the script more readable.</p>

<h2>Section 5: Interacting With Google</h2>
<p>Now we are ready to start automating the steps we ran manually using Watir.</p>
<h3>Beginning the test case</h3>
<p>What you see in the text editor:</p>
<div class = "testexample">
   puts <font color = "purple">"## Beginning of test: google search"</font><br>
   puts <font color = "purple">"  "</font>
</div>
<p><i>Puts</i> is a reserved word in the Ruby language that tells the Ruby Interpreter to print whatever comes after it contained in quotes to the screen.
We could just as easily write this information to a file. These <i>puts</i> statements are in this test case to make it more self-explanatory. Not only to they
tell the user what is happening in the test case, they double as comments. Printing what we are doing when we automate the test case is useful for debugging when developing
test cases, and for quickly repeating failures for bug reports when the test case doesn't pass.</p>

<h3>Step 1: Go to the Google site</h3>
<p>This test case follows a pattern of printing out what we intend Watir to do on a web application, followed by the Watir scripting code to carry out 
that action, and finally printing out the action that Watir just executed. This is a style of test case development that is useful for tracking down test case
failures quickly.</p>
<p>What you see in the text editor:</p>
<div class = "testexample">
 puts <font color = "purple">"Step 1: go to the test site: "</font> + testSite<br>
 $ie.goto(testSite)<br>
 puts <font color = "purple">&nbsp;&nbsp;&nbsp;Action: entered "</font> + testSite + <font color = "purple">"in the address bar."</font><br>
</div>
<p>The first line uses a <i>puts</i> statement to print out the test case step we are attempting to the screen. The second line uses the Watir method "goto" to direct the test
case to the test site: http://www.google.com (stored in the variable <b>testSite</b>). The third line prints the action that Watir just executed to the screen.
When we print out the variable, we concatenate it to the string (the part in quotes) by using the <b>+</b> sign. 
</p>

<h3>Step 2: Enter Search Term "pickaxe" in the search field</h3>
<p>We need to enter the term to search in the text field on the Google home page.</p>
<p>What you see in the web browser:</p>
<div class = "browserexample">
<input maxLength=256 size=55 name=q value=""></div>
<p>What you see in the text editor:</p>
<div class = "testexample">
 puts <font color = "purple">"Step 2: enter "pickaxe" in the search text field"<br></font>
 $ie.textField(:name, <font color = "purple">"q"</font>).set(<font color = "purple">"pickaxe"</font>)<font color = "green"> # q is the name of the search field</font><br> 
 puts <font color = "purple">&nbsp;&nbsp;&nbsp;"  Action: entered pickaxe in the search field"</font><br>
</div>
<p>The first line prints the step we are on to the screen. The second line enters the text "pickaxe" in the text field named <b>q</b>. The third line prints what Watir just executed 
to the screen.</p>
<p>This is the tag in the HTML source with the <i>name</i> attribute we used highlighted:</p>
<div class = "htmlexample">
&lt;input maxLength=256 size=55 name=<b>q</b> value=""&gt;</div>
<p>The text field has a <i>name</i> attribute <b>q</b>, so we use that to tell Watir what object to interact with.</p>

<h3>Step 3: Click the "Google Search" button</h3>
<p>We need to click the search button to activate the Google Search functionality.</p>
<p>What you see in the web browser:</p>
<div class = "browserexample">
<input type=submit value="Google Search" name=btnG></div>
<p>What you see in the text editor:</p>
<div class = "testexample">
 puts <font color = "purple">"Step 3: click the 'Google Search' button"<br></font>
  $ie.button(:value,  <font color = "purple">"Google Search"</font>).click<font color = "green"> # Google Search is the value of the button</font><br> 
 puts <font color = "purple">&nbsp;&nbsp;&nbsp;"  Action: clicked the Google Search button."</font><br>
</div>
<p>The first line prints the step we are on to the screen. The second line clicks the Google Search button. The third line prints what Watir just executed 
to the screen.</p>
<p>This is the tag in the HTML source with the <i>value</i> (or caption) attribute we used highlighted:</p>
<div class = "htmlexample">
&lt;input type=submit value="<b>Google Search</b>" name=btnG&gt;</div>

<h2>Section 6: Evaluating the Results</h2>
<h3>The Expected Result</h3>
<p>This test case prints out what the Expected Result should be prior to the test case using Watir to evaluate the results.</p>
<p>What you see in the text editor:</p>
<div class = "testexample">
   puts <font color = "purple">"Expected Result: "</font><br>
   puts <font color = "purple">" - a Google page with results should be shown. "Pragmatic Programmers LLC" should be high on the list."</font>
</div>
<p>These two statements simply print the Expected Result of the test to the screen.</p>
<h3>Verify Results</h3>
<p>Using Watir and a little Ruby, we can evaluate the results to verify whether the test case passed or failed.</p>
<div class = "testexample">
puts <font color = "purple">"Actual Result: Check that the 'The Pragmatic Programmers, LLC' link appears on the search results page"<br></font>
   a = $ie.pageContainsText("<font color = "purple">The Pragmatic Programmers, LLC</font>")<br> 
   <font color = "darkblue">if</font> !a <br>
      &nbsp;&nbsp;&nbsp;puts <font color = "purple">"Test Failed! Could not find: The Pragmatic Programmers, LLC"</font> <br>
   <font color = "darkblue">else</font><br>
      &nbsp;&nbsp;&nbsp;puts <font color = "purple">"Test Passed. Found the test string: The Pragmatic Programmers, LLC. Actual Results match Expected Results."</font><br>
   <font color = "darkblue">end</font><br>
</div>
<p>There is a lot more in this section, but we can break it down.<ul>
<li>The first line prints out the "Actual Result" heading to the screen.</li>
<li>The second line calls the "pageContainsText" method, and asks it to verify that <i>The Pragmatic Programmers, LLC</i> appears on the first page.</li>
<ul><li>We assign the result of that method call to a variable called <b>a</b>, so we can evaluate the result and print a PASS or FAILURE message.</li></ul>
<li>Using an <i>if</i> statement, we evaluate whether the pageContainsText method was True or False.</li>
<ul><li>If pageContainsText returns false, the text <i>The Pragmatic Programmers, LLC</i> does not appear. The test case fails and we print the "Test Failed!" message.</li>
<li>Else, if pageContainsText returns true, the text <i>The Pragmatic Programmers, LLC</i> appears. The test case passes and we print the "Test Passed." message.</li>
<li>We close the conditional <i>if</i> section with an <i>end</i> statement.</li></ul>
</ul>
</p>
<h3>End of Test Case</h3>
<p>What you see in the text editor:</p>
<div class = "testexample">
    puts <font color = "purple">"  "</font><br>
    puts <font color = "purple">"## end of test: google search"</font><br>
    puts <font color = "green"># -end of simple google search test</font>
</div>
<p>The first line prints a blank line for formatting, and a the second line prints message to the user that the test case has ended. The final line in green 
is a comment that shows the end of the test case. 
</p>
</body>
</html>
